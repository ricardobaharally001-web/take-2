{% extends "base_store.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h2 class="mb-0">Manage Categories</h2>
  <a href="{{ url_for('store.admin') }}" class="btn btn-outline-secondary"><i class="bi bi-arrow-left me-1"></i>Back</a>
</div>

<div class="card mb-4">
  <div class="card-header"><h5 class="mb-0">Add New Category</h5></div>
  <div class="card-body">
    <form method="POST">
      <div class="row g-3 align-items-end">
        <div class="col-md-8">
          <label class="form-label">Category Name</label>
          <input type="text" class="form-control" name="name" placeholder="e.g. Shirts" required>
        </div>
        <div class="col-md-4">
          <button type="submit" class="btn btn-primary w-100"><i class="bi bi-plus-circle me-1"></i>Add Category</button>
        </div>
      </div>
    </form>
  </div>
</div>

<div class="card">
  <div class="card-header"><h5 class="mb-0">All Categories ({{ categories|length }})</h5></div>
  <div class="card-body">
    {% if categories %}
    <div class="table-responsive">
      <table class="table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Slug</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for c in categories %}
          <tr>
            <td>{{ c.name }}</td>
            <td>{{ c.slug }}</td>
            <td class="d-flex gap-2">
              {% if c.slug != 'all' %}
              <a href="{{ url_for('store.admin_category', slug=c.slug) }}" class="btn btn-sm btn-outline-primary"><i class="bi bi-box-arrow-in-right me-1"></i>Open</a>
              <form method="POST" action="{{ url_for('store.admin_delete_category', slug=c.slug) }}" onsubmit="return confirm('Delete this category? Products will remain uncategorized.');">
                <button class="btn btn-sm btn-outline-danger" type="submit"><i class="bi bi-trash"></i></button>
              </form>
              {% else %}
              <span class="text-muted small">Default</span>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <p class="text-muted">No categories found.</p>
    {% endif %}
  </div>
</div>
{% endblock %}
