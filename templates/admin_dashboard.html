{% extends "base_admin.html" %}

{% block content %}
<!-- Dashboard Header -->
<div class="d-flex justify-content-between align-items-center mb-4">
  <div>
    <h1 class="h3 mb-0">üìä Dashboard</h1>
    <p class="text-muted mb-0">Welcome back, {{ current_user.email }}</p>
  </div>
  <div class="text-muted">
    <small>{{ moment().format('MMMM DD, YYYY') if moment else 'Today' }}</small>
  </div>
</div>

<!-- Professional Stats Cards -->
<div class="admin-stats mb-4">
  <a href="{{ url_for('admin.admin_products') }}" class="text-decoration-none">
    <div class="card h-100 border-primary">
      <div class="card-body text-center">
        <div class="display-6 text-primary mb-3">üì¶</div>
        <h5>{{ product_count }}</h5>
        <p class="text-muted mb-2">Products</p>
        <small class="text-primary">Manage Products ‚Üí</small>
      </div>
    </div>
  </a>
  
  <a href="{{ url_for('admin.admin_categories') }}" class="text-decoration-none">
    <div class="card h-100 border-info">
      <div class="card-body text-center">
        <div class="display-6 text-info mb-3">üìÅ</div>
        <h5>{{ category_count }}</h5>
        <p class="text-muted mb-2">Categories</p>
        <small class="text-info">Organize Products ‚Üí</small>
      </div>
    </div>
  </a>
  
  <a href="{{ url_for('admin.admin_orders') }}" class="text-decoration-none">
    <div class="card h-100 border-success">
      <div class="card-body text-center">
        <div class="display-6 text-success mb-3">üõçÔ∏è</div>
        <h5>{{ order_count }}</h5>
        <p class="text-muted mb-2">Orders</p>
        <small class="text-success">View Orders ‚Üí</small>
      </div>
    </div>
  </a>
  
  {% if low_stock_products > 0 %}
  <a href="{{ url_for('admin.admin_products') }}" class="text-decoration-none">
    <div class="card h-100 border-warning">
      <div class="card-body text-center">
        <div class="display-6 text-warning mb-3">‚ö†Ô∏è</div>
        <h5>{{ low_stock_products }}</h5>
        <p class="text-muted mb-2">Low Stock</p>
        <small class="text-warning">Restock Items ‚Üí</small>
      </div>
    </div>
  </a>
  {% else %}
  <a href="{{ url_for('admin.settings_view') }}" class="text-decoration-none">
    <div class="card h-100 border-secondary">
      <div class="card-body text-center">
        <div class="display-6 text-secondary mb-3">üé®</div>
        <h5>{{ settings.theme_color|title }}</h5>
        <p class="text-muted mb-2">Theme</p>
        <small class="text-secondary">Change Theme ‚Üí</small>
      </div>
    </div>
  </a>
  {% endif %}
</div>

<!-- Dashboard Content Row -->
<div class="row g-4">
  <!-- Recent Orders -->
  <div class="col-lg-8">
    <div class="card h-100">
      <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0">
          <i class="bi bi-clock-history me-2"></i>
          Recent Orders
        </h5>
        <a href="{{ url_for('admin.admin_orders') }}" class="btn btn-sm btn-outline-primary">
          View All
        </a>
      </div>
      <div class="card-body">
        {% if recent_orders %}
          <div class="table-responsive">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th>Order #</th>
                  <th>Customer</th>
                  <th>Total</th>
                  <th>Status</th>
                  <th>Date</th>
                </tr>
              </thead>
              <tbody>
                {% for order in recent_orders %}
                <tr>
                  <td>
                    <code class="fs-6">#{{ order.id }}</code>
                  </td>
                  <td>
                    <div>
                      <strong>{{ order.customer_name }}</strong>
                      <br>
                      <small class="text-muted">{{ order.email }}</small>
                    </div>
                  </td>
                  <td>
                    <strong>{{ order.subtotal|gyd }}</strong>
                  </td>
                  <td>
                    <span class="badge bg-{{ 'success' if order.status == 'paid' else 'warning' }}">
                      {{ order.status|title }}
                    </span>
                  </td>
                  <td>
                    <small class="text-muted">
                      {{ order.created_at.strftime('%m/%d %H:%M') }}
                    </small>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% else %}
          <div class="text-center py-4">
            <div class="display-6 text-muted mb-3">üìã</div>
            <h6 class="text-muted">No orders yet</h6>
            <p class="text-muted small">Orders will appear here when customers make purchases.</p>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
  
  <!-- Quick Actions -->
  <div class="col-lg-4">
    <div class="card h-100">
      <div class="card-header">
        <h5 class="mb-0">
          <i class="bi bi-lightning me-2"></i>
          Quick Actions
        </h5>
      </div>
      <div class="card-body d-flex flex-column">
        <a href="{{ url_for('admin.admin_products_new') }}" class="btn btn-primary mb-3">
          <i class="bi bi-plus-circle me-2"></i>
          Add New Product
        </a>
        <a href="{{ url_for('admin.admin_categories_new') }}" class="btn btn-outline-info mb-3">
          <i class="bi bi-folder-plus me-2"></i>
          Create Category
        </a>
        <a href="{{ url_for('admin.settings_view') }}" class="btn btn-outline-secondary mb-3">
          <i class="bi bi-gear me-2"></i>
          Store Settings
        </a>
        <a href="{{ url_for('admin.admin_orders') }}" class="btn btn-outline-success mb-3">
          <i class="bi bi-list-check me-2"></i>
          View Orders
        </a>
        <div class="mt-auto">
          <a href="{{ url_for('store.index') }}" class="btn btn-outline-primary w-100" target="_blank">
            <i class="bi bi-eye me-2"></i>
            View Store
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Store Information -->
<div class="row mt-4">
  <div class="col-12">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0">
          <i class="bi bi-shop me-2"></i>
          Store Information
        </h5>
      </div>
      <div class="card-body">
        <div class="row g-4">
          <div class="col-md-6 col-lg-3">
            <div class="text-center">
              <strong class="d-block">Store Name</strong>
              <span class="text-muted">{{ settings.store_name }}</span>
            </div>
          </div>
          <div class="col-md-6 col-lg-3">
            <div class="text-center">
              <strong class="d-block">Tagline</strong>
              <span class="text-muted">{{ settings.tagline or 'Not set' }}</span>
            </div>
          </div>
          <div class="col-md-6 col-lg-3">
            <div class="text-center">
              <strong class="d-block">Contact Email</strong>
              <span class="text-muted">{{ settings.contact_email or 'Not set' }}</span>
            </div>
          </div>
          <div class="col-md-6 col-lg-3">
            <div class="text-center">
              <strong class="d-block">Phone</strong>
              <span class="text-muted">{{ settings.phone or 'Not set' }}</span>
            </div>
          </div>
          <div class="col-md-6 col-lg-3">
            <div class="text-center">
              <strong class="d-block">Theme</strong>
              <span class="badge" style="background-color: var(--primary-blue);">{{ settings.theme_color|title }}</span>
            </div>
          </div>
          <div class="col-md-6 col-lg-3">
            <div class="text-center">
              <strong class="d-block">PayPal Status</strong>
              {% if settings.paypal_client_id and settings.paypal_client_id != 'YOUR_PAYPAL_CLIENT_ID' %}
                <span class="text-success">‚úÖ Configured</span>
              {% else %}
                <span class="text-warning">‚ö†Ô∏è Not configured</span>
              {% endif %}
            </div>
          </div>
          <div class="col-md-6 col-lg-3">
            <div class="text-center">
              <strong class="d-block">Address</strong>
              <span class="text-muted">{{ settings.address or 'Not set' }}</span>
            </div>
          </div>
          <div class="col-md-6 col-lg-3">
            <div class="text-center">
              <strong class="d-block">Logo</strong>
              {% if settings.logo_filename %}
                <span class="text-success">‚úÖ Uploaded</span>
              {% else %}
                <span class="text-warning">‚ö†Ô∏è Not set</span>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
